<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hand Tracker</title>
  <style>
    body { margin:0; background:#0b132b; overflow:hidden; }
    canvas { position:fixed; top:0; left:0; }
    video { display:none; }
  </style>
</head>
<body>

<video id="video"></video>
<canvas id="canvas"></canvas>

<script type="module">
import {
  FilesetResolver,
  HandLandmarker
} from "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.0";

const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const stream = await navigator.mediaDevices.getUserMedia({ video:true });
video.srcObject = stream;
await video.play();

const filesetResolver = await FilesetResolver.forVisionTasks(
  "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.0/wasm"
);

const handLandmarker = await HandLandmarker.createFromOptions(
  filesetResolver,
  {
    baseOptions: {
      modelAssetPath:
        "https://storage.googleapis.com/mediapipe-models/hand_landmarker/hand_landmarker/float16/1/hand_landmarker.task"
    },
    numHands: 1,
    runningMode: "VIDEO"
  }
);

function loop(){
  const res = handLandmarker.detectForVideo(video, performance.now());
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(res.landmarks){
    for(const hand of res.landmarks){
      for(const p of hand){
        ctx.beginPath();
        ctx.arc(p.x*canvas.width, p.y*canvas.height, 6, 0, Math.PI*2);
        ctx.fillStyle = "#00f5ff";
        ctx.fill();
      }
    }
  }
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>